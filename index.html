<!DOCTYPE html>
<html>
  <head>
    <title>Terminal Faker Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="terminal.css">
    <script>
        /* ************* TODO ***************
           - Slowly load in a better intro line by line.
           - Push to github.
           - New fork name.
           - Basic file browsing.
        ********************/

        var version = '1.0.0';

    </script>
    <style>
      body {
        background: black;
        color:      white;

        width:  100%;
        height: 100%;

        padding: 0;
        margin:  0;

        font-size:1.3em;

        box-sizing: border-box;
      }
    </style>

  </head>
  <body>
    <h1>Terminal Faker Demo</h1>
    <div id="terminal">
      <p id="intro">Type 'help' to get started.</p>
      <p class="hidden">
        <span class="prompt"></span>
        <span contenteditable="true" class="input"> </span>
      </p>
    </div>
    <script src="terminal.js"></script>
    <script>

      var commands = {};

      /**
       * Clears the terminal using a special flag on the resetPrompt function.
       **/
      commands.clear = {
          about:  "Clear the terminal window.",
          exe:  function() {
              return "";
          }
      };

      /**
       * Prints a greeting to the user or to the given name.
       **/
      commands.hello = {
          about:  "Greet the user with a message.",
          exe:  function(args) {
            if(args.length < 2) return "<p>Hello. Why don't you tell me your name?</p>";
            return "Hello " + args[1];
          }
      };

      /**
       * Lists all available commands or the help for a given command.
       **/
      commands.help = {
          about: "Show a list of available commands.",
          exe: function(args) {
            var output = "<div>";
            if(args.length == 2 && args[0] && args[0] in commands) {
                output +=  "<strong>"+args[1]+"</strong>: "+ commands[args[1]].about +"";
            }else{
                output += "TERM bash, version "+version+"-release (x86_64-pc-linux-gnu)<br>These shell commands are defined internally.  Type 'help' to see this list.<br>Type `help name' to find out more about the function 'name'.<br><br>";
                output += "";

                Object.keys(commands).forEach( function(cName) {
                    output += "<strong>"+cName+"</strong>&nbsp;&nbsp;&nbsp;";
                });
            }
            output += "<br><br></div>";
            return output;
          }
      };

      /**
       * Lists the recent commands.
       **/
      commands.history = {
          about:  "Display the list of recent commands.<br>&nbsp;&nbsp;-c  clear the history list.",
          exe:  function(args) {
            if( args.length == 2 && args[1] == "-c"){
                localStorage.setItem("history", []);
                term.history = [];

            }
            var history = term.history;
            var output = "";

            history.forEach(function(element, index){
                output += index + "&nbsp;&nbsp;"+element+"<br>";
            });
            return output;
          }
      };


      // Set the command prompt style:
      var customPrompt = function () { return "<span style='color:#00ffff;'>user@terminal.js $</span> ";};

      // Initialize the terminal:
      var term = Terminal.init(document.getElementById("terminal"), commands, customPrompt);

    </script>
  </body>
</html>
